{"version": null, "code": "gASV0Q4AAAAAAAAoQxJ0AGQBfA58EWQCjQMBAGQAUwCUKIwFaW5wdXSUjAZvdXRwdXSUjAZwYXJhbXOUjAl3aWxkY2FyZHOUjAd0aHJlYWRzlIwJcmVzb3VyY2VzlIwDbG9nlIwHdmVyc2lvbpSMBHJ1bGWUjAljb25kYV9lbnaUjA1jb250YWluZXJfaW1nlIwQc2luZ3VsYXJpdHlfYXJnc5SMD3VzZV9zaW5ndWxhcml0eZSMC2Vudl9tb2R1bGVzlIwMYmVuY2hfcmVjb3JklIwFam9iaWSUjAhpc19zaGVsbJSMD2JlbmNoX2l0ZXJhdGlvbpSMD2NsZWFudXBfc2NyaXB0c5SMCnNoYWRvd19kaXKUjA1lZGl0X25vdGVib29rlHSUXZQoTliVDQAACiAgICAgICAgLiAvdS9sb2NhbC9Nb2R1bGVzL2RlZmF1bHQvaW5pdC9tb2R1bGVzLnNoCiAgICAgICAgbW9kdWxlIGxvYWQgcGxpbmsvMS45MGIzLjQ1CiAgICAgICAgbWtkaXIgLXAge3BhcmFtcy5vdXRkaXJ9CiAgICAgICAgbWtkaXIgLXAge3BhcmFtcy5vdXRkaXJ9L3BsaW5rX2xvZwoKICAgICAgICAjIDAuIEluIHR1dG9yaWFsLCBidXQgbm90IGRvaW5nOiBmaWx0ZXIgcmVmZXJlbmNlIGFuZCBzdHVkeSBkYXRhIGZvciBub24gQS1UIG9yIEctQyBTTlBzCgoJICAgICMgMS4gUHJ1bmUgc3R1ZHkgZGF0YS4gRmlsdGVyIGZvciB2YXJpYW50cyBpbiBMRCB3aXRoIHJeMj4uMiBpbiBhIDUwa2Igd2luZG93CiAgICAgICAgcGxpbmsgLS1iZmlsZSB7cGFyYW1zLmRhdGF9ICAgICAgICAgICAgICAgLS1pbmRlcC1wYWlyd2lzZSA1MCA1IDAuMiAgICAgICAgICAgICAgIC0tb3V0IHtwYXJhbXMub3V0ZGlyfS9kYXRhCgogICAgICAgIHBsaW5rIC0tYmZpbGUge3BhcmFtcy5kYXRhfSAgICAgICAgICAgICAgIC0tZXh0cmFjdCB7cGFyYW1zLm91dGRpcn0vZGF0YS5wcnVuZS5pbiAgICAgICAgICAgICAgIC0tbWFrZS1iZWQgICAgICAgICAgICAgICAtLW91dCB7cGFyYW1zLm91dGRpcn0vZGF0YS5wcnVuZWQKCgkgICAgIyAyLiBGaWx0ZXIgcmVmZXJlbmNlIGRhdGEgZm9yIHRoZSBzYW1lIFNOUCBzZXQgYXMgaW4gc3R1ZHkuIFJlZHVjZSByZWZlcmVuY2UgdG8gdGhlIHNhbWUgc2l6ZQogICAgICAgIHBsaW5rIC0tYmZpbGUge3BhcmFtcy5yZWZ9ICAgICAgICAgICAgICAgLS1leHRyYWN0IHtwYXJhbXMub3V0ZGlyfS9kYXRhLnBydW5lLmluICAgICAgICAgICAgICAgLS1tYWtlLWJlZCAgICAgICAgICAgICAgIC0tb3V0IHtwYXJhbXMub3V0ZGlyfS9yZWYucHJ1bmVkCgogICAgICAgICMgMy4gQ2hlY2sgYW5kIGNvcnJlY3QgY2hyb21vc29tZSBtaXNtYXRjaC4gQ2hlY2sgdGhhdCB0aGUgdmFyaWFudCBJRHMgb2YgdGhlIHJlZmVyZW5jZSBkYXRhIGhhdmUgdGhlIHNhbWUgY2hyb21vc29tZSBJRCBhcyB0aGUgc3R1ZHkgZGF0YSwgdXBkYXRlIHRoZSBwcnVuZWQgcmVmZXJlbmNlIGRhdGFzZXQKICAgICAgICBhd2sgJ0JFR0lOIHt7T0ZTPSIJIn19IEZOUj09TlIge3thWyQyXT0kMTsgbmV4dH19ICAgICAgICAgKCQyIGluIGEgJiYgYVskMl0gIT0gJDEpIHt7cHJpbnQgYVskMl0sJDJ9fScgICAgICAgICB7cGFyYW1zLm91dGRpcn0vZGF0YS5wcnVuZWQuYmltIHtwYXJhbXMub3V0ZGlyfS9yZWYucHJ1bmVkLmJpbSB8ICAgICAgICAgc2VkIC1uICcvXltYWV0vIXAnID4ge3BhcmFtcy5vdXRkaXJ9L3JlZi50b1VwZGF0ZUNocgoKICAgICAgICAjIENvcnJlY3QgY2hyb21vc29tZSBtaXNtYXRjaAogICAgICAgIHBsaW5rIC0tYmZpbGUge3BhcmFtcy5vdXRkaXJ9L3JlZi5wcnVuZWQgICAgICAgICAgICAgICAtLXVwZGF0ZS1jaHIge3BhcmFtcy5vdXRkaXJ9L3JlZi50b1VwZGF0ZUNociAxIDIgICAgICAgICAgICAgICAtLW1ha2UtYmVkICAgICAgICAgICAgICAgLS1vdXQge3BhcmFtcy5vdXRkaXJ9L3JlZi51cGRhdGVDaHIKCiAgICAgICAgIyA0LiBDaGVjayBhbmQgY29ycmVjdCBwb3NpdGlvbiBtaXNtYXRjaAogICAgICAgIGF3ayAnQkVHSU4ge3tPRlM9IgkifX0gRk5SPT1OUiB7e2FbJDJdPSQ0OyBuZXh0fX0gICAgICAgICAoJDIgaW4gYSAmJiBhWyQyXSAhPSAkNCkge3twcmludCBhWyQyXSwkMn19JyAgICAgICAgIHtwYXJhbXMub3V0ZGlyfS9kYXRhLnBydW5lZC5iaW0ge3BhcmFtcy5vdXRkaXJ9L3JlZi5wcnVuZWQuYmltID4gICAgICAgICB7cGFyYW1zLm91dGRpcn0vcmVmLnRvVXBkYXRlUG9zCgogICAgICAgICMgUG9zc2libGUgYWxsZWxlIGZsaXBzCiAgICAgICAgYXdrICdCRUdJTiB7e09GUz0iCSJ9fSBGTlI9PU5SIHt7YVskMSQyJDRdPSQ1JDY7IG5leHR9fSAgICAgICAgICgkMSQyJDQgaW4gYSAmJiBhWyQxJDIkNF0gIT0gJDUkNiAmJiBhWyQxJDIkNF0gIT0gJDYkNSkge3twcmludCAkMn19JyAgICAgICAgIHtwYXJhbXMub3V0ZGlyfS9kYXRhLnBydW5lZC5iaW0ge3BhcmFtcy5vdXRkaXJ9L3JlZi5wcnVuZWQuYmltID4gICAgICAgICB7cGFyYW1zLm91dGRpcn0vcmVmLnRvRmxpcAoKICAgICAgICAjIFVwZGF0ZSBwb3NpdGlvbiBhbmQgYWxsZWxlIGZsaXBzCiAgICAgICAgcGxpbmsgLS1iZmlsZSB7cGFyYW1zLm91dGRpcn0vcmVmLnVwZGF0ZUNociAgICAgICAgICAgICAgIC0tdXBkYXRlLW1hcCB7cGFyYW1zLm91dGRpcn0vcmVmLnRvVXBkYXRlUG9zIDEgMiAgICAgICAgICAgICAgIC0tZmxpcCB7cGFyYW1zLm91dGRpcn0vcmVmLnRvRmxpcCAgICAgICAgICAgICAgIC0tbWFrZS1iZWQgICAgICAgICAgICAgICAtLW91dCB7cGFyYW1zLm91dGRpcn0vcmVmLmZsaXBwZWQKCiAgICAgICAgIyA1LiBSZW1vdmUgbWlzbWF0Y2hlcyBpbiByZWYuIEFueSBhbGxlbGVzIG5vdCBtYXRjaGluZyBhZnRlciBhbGxlbGUgZmxpcHBpbmcgYXJlIGlkZW50aWZpZWQgYW5kIHJlbW92ZWQgZnJvbSB0aGUgcmVmZXJlbmNlCiAgICAgICAgYXdrICdCRUdJTiB7e09GUz0iCSJ9fSBGTlI9PU5SIHt7YVskMSQyJDRdPSQ1JDY7IG5leHR9fSAgICAgICAgICgkMSQyJDQgaW4gYSAmJiBhWyQxJDIkNF0gIT0gJDUkNiAmJiBhWyQxJDIkNF0gIT0gJDYkNSkge3twcmludCAkMn19JyAgICAgICAgIHtwYXJhbXMub3V0ZGlyfS9kYXRhLnBydW5lZC5iaW0ge3BhcmFtcy5vdXRkaXJ9L3JlZi5mbGlwcGVkLmJpbSA+ICAgICAgICAge3BhcmFtcy5vdXRkaXJ9L3JlZi5taXNtYXRjaAoKICAgICAgICBwbGluayAtLWJmaWxlIHtwYXJhbXMub3V0ZGlyfS9yZWYuZmxpcHBlZCAgICAgICAgICAgICAgIC0tZXhjbHVkZSB7cGFyYW1zLm91dGRpcn0vcmVmLm1pc21hdGNoICAgICAgICAgICAgICAgLS1tYWtlLWJlZCAgICAgICAgICAgICAgIC0tb3V0IHtwYXJhbXMub3V0ZGlyfS9yZWYuY2xlYW4KCiAgICAgICAgIyA2LiBNZXJnZSBzdHVkeSBnZW5vdHlwZXMgYW5kIHJlZgogICAgICAgIHBsaW5rIC0tYmZpbGUge3BhcmFtcy5vdXRkaXJ9L2RhdGEucHJ1bmVkICAgICAgICAgICAgICAgLS1ibWVyZ2Uge3BhcmFtcy5vdXRkaXJ9L3JlZi5jbGVhbi5iZWQgICAgICAgICAgICAgICB7cGFyYW1zLm91dGRpcn0vcmVmLmNsZWFuLmJpbSAgICAgICAgICAgICAgIHtwYXJhbXMub3V0ZGlyfS9yZWYuY2xlYW4uZmFtICAgICAgICAgICAgICAgLS1tYWtlLWJlZCAgICAgICAgICAgICAgIC0tb3V0IHtwYXJhbXMub3V0ZGlyfS9kYXRhLm1lcmdlLnJlZgoKICAgICAgICAjIDcuIFBDQSBvbiB0aGUgbWVyZ2VkIGRhdGEKICAgICAgICBwbGluayAtLWJmaWxlIHtwYXJhbXMub3V0ZGlyfS9kYXRhLm1lcmdlLnJlZiAgICAgICAgICAgICAgIC0tcGNhICAgICAgICAgICAgICAgLS1vdXQge3BhcmFtcy5vdXRkaXJ9L2RhdGEucmVmCgogICAgICAgIG12IHtwYXJhbXMub3V0ZGlyfS8qLmxvZyB7cGFyYW1zLm91dGRpcn0vcGxpbmtfbG9nCiAgICAgICAglGgPaBKGlGWMBXNoZWxslIWUdJQu", "rule": "pca_ancestry", "input": ["/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/filtered.hg19.sorted.bed", "/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/filtered.hg19.sorted.bim", "/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/filtered.hg19.sorted.fam", "/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/filtered.hg19.sorted.log", "/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/filtered.hg19.sorted.nosex"], "log": [], "params": ["'/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/filtered.hg19.sorted'", "'/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca'", "'/u/project/gandalm/shared/refGenomes/g1000/Phase3_ALL/ALL.autosomes.phase3'"], "shellcmd": "\n        . /u/local/Modules/default/init/modules.sh\n        module load plink/1.90b3.45\n        mkdir -p /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca\n        mkdir -p /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/plink_log\n\n        # 0. In tutorial, but not doing: filter reference and study data for non A-T or G-C SNPs\n\n\t    # 1. Prune study data. Filter for variants in LD with r^2>.2 in a 50kb window\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/filtered.hg19.sorted               --indep-pairwise 50 5 0.2               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data\n\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/filtered.hg19.sorted               --extract /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.prune.in               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.pruned\n\n\t    # 2. Filter reference data for the same SNP set as in study. Reduce reference to the same size\n        plink --bfile /u/project/gandalm/shared/refGenomes/g1000/Phase3_ALL/ALL.autosomes.phase3               --extract /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.prune.in               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.pruned\n\n        # 3. Check and correct chromosome mismatch. Check that the variant IDs of the reference data have the same chromosome ID as the study data, update the pruned reference dataset\n        awk 'BEGIN {OFS=\"\t\"} FNR==NR {a[$2]=$1; next}         ($2 in a && a[$2] != $1) {print a[$2],$2}'         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.pruned.bim /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.pruned.bim |         sed -n '/^[XY]/!p' > /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.toUpdateChr\n\n        # Correct chromosome mismatch\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.pruned               --update-chr /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.toUpdateChr 1 2               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.updateChr\n\n        # 4. Check and correct position mismatch\n        awk 'BEGIN {OFS=\"\t\"} FNR==NR {a[$2]=$4; next}         ($2 in a && a[$2] != $4) {print a[$2],$2}'         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.pruned.bim /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.pruned.bim >         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.toUpdatePos\n\n        # Possible allele flips\n        awk 'BEGIN {OFS=\"\t\"} FNR==NR {a[$1$2$4]=$5$6; next}         ($1$2$4 in a && a[$1$2$4] != $5$6 && a[$1$2$4] != $6$5) {print $2}'         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.pruned.bim /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.pruned.bim >         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.toFlip\n\n        # Update position and allele flips\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.updateChr               --update-map /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.toUpdatePos 1 2               --flip /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.toFlip               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.flipped\n\n        # 5. Remove mismatches in ref. Any alleles not matching after allele flipping are identified and removed from the reference\n        awk 'BEGIN {OFS=\"\t\"} FNR==NR {a[$1$2$4]=$5$6; next}         ($1$2$4 in a && a[$1$2$4] != $5$6 && a[$1$2$4] != $6$5) {print $2}'         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.pruned.bim /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.flipped.bim >         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.mismatch\n\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.flipped               --exclude /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.mismatch               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.clean\n\n        # 6. Merge study genotypes and ref\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.pruned               --bmerge /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.clean.bed               /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.clean.bim               /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/ref.clean.fam               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.merge.ref\n\n        # 7. PCA on the merged data\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.merge.ref               --pca               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/data.ref\n\n        mv /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/*.log /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/amr/pca/plink_log\n        ", "incomplete": false, "starttime": 1614643648.013361, "endtime": 1614643658.408544, "job_hash": 2938417534036, "conda_env": null, "container_img_url": null}