{"version": null, "code": "gASV+w4AAAAAAAAoQxJ0AGQBfA58EWQCjQMBAGQAUwCUKIwFaW5wdXSUjAZvdXRwdXSUjAZwYXJhbXOUjAl3aWxkY2FyZHOUjAd0aHJlYWRzlIwJcmVzb3VyY2VzlIwDbG9nlIwHdmVyc2lvbpSMBHJ1bGWUjAljb25kYV9lbnaUjA1jb250YWluZXJfaW1nlIwQc2luZ3VsYXJpdHlfYXJnc5SMD3VzZV9zaW5ndWxhcml0eZSMC2Vudl9tb2R1bGVzlIwMYmVuY2hfcmVjb3JklIwFam9iaWSUjAhpc19zaGVsbJSMD2JlbmNoX2l0ZXJhdGlvbpSMD2NsZWFudXBfc2NyaXB0c5SMCnNoYWRvd19kaXKUjA1lZGl0X25vdGVib29rlHSUXZQoTli/DQAACiAgICAgICAgLiAvdS9sb2NhbC9Nb2R1bGVzL2RlZmF1bHQvaW5pdC9tb2R1bGVzLnNoCiAgICAgICAgbW9kdWxlIGxvYWQgcGxpbmsvMS45MGIzLjQ1CiAgICAgICAgbWtkaXIgLXAge3BhcmFtcy5vdXRkaXJ9CiAgICAgICAgbWtkaXIgLXAge3BhcmFtcy5vdXRkaXJ9L3BsaW5rX2xvZwoKICAgICAgICAjIDAuIEluIHR1dG9yaWFsLCBidXQgbm90IGRvaW5nOiBmaWx0ZXIgcmVmZXJlbmNlIGFuZCBzdHVkeSBkYXRhIGZvciBub24gQS1UIG9yIEctQyBTTlBzCgkKCSMgMS4gUHJ1bmUgc3R1ZHkgZGF0YS4gRmlsdGVyIGZvciB2YXJpYW50cyBpbiBMRCB3aXRoIHJeMj4uMiBpbiBhIDUwa2Igd2luZG93CiAgICAgICAgcGxpbmsgLS1iZmlsZSB7cGFyYW1zLmRhdGF9ICAgICAgICAgICAgICAgLS1pbmRlcC1wYWlyd2lzZSA1MCA1IDAuMiAgICAgICAgICAgICAgIC0tb3V0IHtwYXJhbXMub3V0ZGlyfS9kYXRhCgogICAgICAgIHBsaW5rIC0tYmZpbGUge3BhcmFtcy5kYXRhfSAgICAgICAgICAgICAgIC0tZXh0cmFjdCB7cGFyYW1zLm91dGRpcn0vZGF0YS5wcnVuZS5pbiAgICAgICAgICAgICAgIC0tbWFrZS1iZWQgICAgICAgICAgICAgICAtLW91dCB7cGFyYW1zLm91dGRpcn0vZGF0YS5wcnVuZWQKCQoJIyAyLiBGaWx0ZXIgcmVmZXJlbmNlIGRhdGEgZm9yIHRoZSBzYW1lIFNOUCBzZXQgYXMgaW4gc3R1ZHkuIFJlZHVjZSByZWZlcmVuY2UgdG8gdGhlIHNhbWUgc2l6ZQogICAgICAgIHBsaW5rIC0tYmZpbGUge3BhcmFtcy5yZWZ9ICAgICAgICAgICAgICAgLS1leHRyYWN0IHtwYXJhbXMub3V0ZGlyfS9kYXRhLnBydW5lLmluICAgICAgICAgICAgICAgLS1tYWtlLWJlZCAgICAgICAgICAgICAgIC0tb3V0IHtwYXJhbXMub3V0ZGlyfS9yZWYucHJ1bmVkCiAgICAgICAgCiAgICAgICAgIyAzLiBDaGVjayBhbmQgY29ycmVjdCBjaHJvbW9zb21lIG1pc21hdGNoLiBDaGVjayB0aGF0IHRoZSB2YXJpYW50IElEcyBvZiB0aGUgcmVmZXJlbmNlIGRhdGEgaGF2ZSB0aGUgc2FtZSBjaHJvbW9zb21lIElEIGFzIHRoZSBzdHVkeSBkYXRhLCB1cGRhdGUgdGhlIHBydW5lZCByZWZlcmVuY2UgZGF0YXNldAogICAgICAgIGF3ayAnQkVHSU4ge3tPRlM9IgkifX0gRk5SPT1OUiB7e2FbJDJdPSQxOyBuZXh0fX0gICAgICAgICAoJDIgaW4gYSAmJiBhWyQyXSAhPSAkMSkge3twcmludCBhWyQyXSwkMn19JyAgICAgICAgIHtwYXJhbXMub3V0ZGlyfS9kYXRhLnBydW5lZC5iaW0ge3BhcmFtcy5vdXRkaXJ9L3JlZi5wcnVuZWQuYmltIHwgICAgICAgICBzZWQgLW4gJy9eW1hZXS8hcCcgPiB7cGFyYW1zLm91dGRpcn0vcmVmLnRvVXBkYXRlQ2hyCiAgICAgICAgCiAgICAgICAgIyBDb3JyZWN0IGNocm9tb3NvbWUgbWlzbWF0Y2gKICAgICAgICBwbGluayAtLWJmaWxlIHtwYXJhbXMub3V0ZGlyfS9yZWYucHJ1bmVkICAgICAgICAgICAgICAgLS11cGRhdGUtY2hyIHtwYXJhbXMub3V0ZGlyfS9yZWYudG9VcGRhdGVDaHIgMSAyICAgICAgICAgICAgICAgLS1tYWtlLWJlZCAgICAgICAgICAgICAgIC0tb3V0IHtwYXJhbXMub3V0ZGlyfS9yZWYudXBkYXRlQ2hyCiAgICAgICAgCiAgICAgICAgIyA0LiBDaGVjayBhbmQgY29ycmVjdCBwb3NpdGlvbiBtaXNtYXRjaAogICAgICAgIGF3ayAnQkVHSU4ge3tPRlM9IgkifX0gRk5SPT1OUiB7e2FbJDJdPSQ0OyBuZXh0fX0gICAgICAgICAoJDIgaW4gYSAmJiBhWyQyXSAhPSAkNCkge3twcmludCBhWyQyXSwkMn19JyAgICAgICAgIHtwYXJhbXMub3V0ZGlyfS9kYXRhLnBydW5lZC5iaW0ge3BhcmFtcy5vdXRkaXJ9L3JlZi5wcnVuZWQuYmltID4gICAgICAgICB7cGFyYW1zLm91dGRpcn0vcmVmLnRvVXBkYXRlUG9zCgogICAgICAgICMgUG9zc2libGUgYWxsZWxlIGZsaXBzCiAgICAgICAgYXdrICdCRUdJTiB7e09GUz0iCSJ9fSBGTlI9PU5SIHt7YVskMSQyJDRdPSQ1JDY7IG5leHR9fSAgICAgICAgICgkMSQyJDQgaW4gYSAmJiBhWyQxJDIkNF0gIT0gJDUkNiAmJiBhWyQxJDIkNF0gIT0gJDYkNSkge3twcmludCAkMn19JyAgICAgICAgIHtwYXJhbXMub3V0ZGlyfS9kYXRhLnBydW5lZC5iaW0ge3BhcmFtcy5vdXRkaXJ9L3JlZi5wcnVuZWQuYmltID4gICAgICAgICB7cGFyYW1zLm91dGRpcn0vcmVmLnRvRmxpcAoKICAgICAgICAjIFVwZGF0ZSBwb3NpdGlvbiBhbmQgYWxsZWxlIGZsaXBzCiAgICAgICAgcGxpbmsgLS1iZmlsZSB7cGFyYW1zLm91dGRpcn0vcmVmLnVwZGF0ZUNociAgICAgICAgICAgICAgIC0tdXBkYXRlLW1hcCB7cGFyYW1zLm91dGRpcn0vcmVmLnRvVXBkYXRlUG9zIDEgMiAgICAgICAgICAgICAgIC0tZmxpcCB7cGFyYW1zLm91dGRpcn0vcmVmLnRvRmxpcCAgICAgICAgICAgICAgIC0tbWFrZS1iZWQgICAgICAgICAgICAgICAtLW91dCB7cGFyYW1zLm91dGRpcn0vcmVmLmZsaXBwZWQKICAgICAgICAKICAgICAgICAjIDUuIFJlbW92ZSBtaXNtYXRjaGVzIGluIHJlZi4gQW55IGFsbGVsZXMgbm90IG1hdGNoaW5nIGFmdGVyIGFsbGVsZSBmbGlwcGluZyBhcmUgaWRlbnRpZmllZCBhbmQgcmVtb3ZlZCBmcm9tIHRoZSByZWZlcmVuY2UKICAgICAgICBhd2sgJ0JFR0lOIHt7T0ZTPSIJIn19IEZOUj09TlIge3thWyQxJDIkNF09JDUkNjsgbmV4dH19ICAgICAgICAgKCQxJDIkNCBpbiBhICYmIGFbJDEkMiQ0XSAhPSAkNSQ2ICYmIGFbJDEkMiQ0XSAhPSAkNiQ1KSB7e3ByaW50ICQyfX0nICAgICAgICAge3BhcmFtcy5vdXRkaXJ9L2RhdGEucHJ1bmVkLmJpbSB7cGFyYW1zLm91dGRpcn0vcmVmLmZsaXBwZWQuYmltID4gICAgICAgICB7cGFyYW1zLm91dGRpcn0vcmVmLm1pc21hdGNoCgogICAgICAgIHBsaW5rIC0tYmZpbGUge3BhcmFtcy5vdXRkaXJ9L3JlZi5mbGlwcGVkICAgICAgICAgICAgICAgLS1leGNsdWRlIHtwYXJhbXMub3V0ZGlyfS9yZWYubWlzbWF0Y2ggICAgICAgICAgICAgICAtLW1ha2UtYmVkICAgICAgICAgICAgICAgLS1vdXQge3BhcmFtcy5vdXRkaXJ9L3JlZi5jbGVhbgoKICAgICAgICAjIDYuIE1lcmdlIHN0dWR5IGdlbm90eXBlcyBhbmQgcmVmCiAgICAgICAgcGxpbmsgLS1iZmlsZSB7cGFyYW1zLm91dGRpcn0vZGF0YS5wcnVuZWQgICAgICAgICAgICAgICAtLWJtZXJnZSB7cGFyYW1zLm91dGRpcn0vcmVmLmNsZWFuLmJlZCAgICAgICAgICAgICAgIHtwYXJhbXMub3V0ZGlyfS9yZWYuY2xlYW4uYmltICAgICAgICAgICAgICAge3BhcmFtcy5vdXRkaXJ9L3JlZi5jbGVhbi5mYW0gICAgICAgICAgICAgICAtLW1ha2UtYmVkICAgICAgICAgICAgICAgLS1vdXQge3BhcmFtcy5vdXRkaXJ9L2RhdGEubWVyZ2UucmVmCiAgICAgICAgCiAgICAgICAgIyA3LiBQQ0Egb24gdGhlIG1lcmdlZCBkYXRhCiAgICAgICAgcGxpbmsgLS1iZmlsZSB7cGFyYW1zLm91dGRpcn0vZGF0YS5tZXJnZS5yZWYgICAgICAgICAgICAgICAtLXBjYSAgICAgICAgICAgICAgIC0tb3V0IHtwYXJhbXMub3V0ZGlyfS9kYXRhLnJlZgogICAgICAgIAogICAgICAgIG12IHtwYXJhbXMub3V0ZGlyfS8qLmxvZyB7cGFyYW1zLm91dGRpcn0vcGxpbmtfbG9nCiAgICAgICAglGgPaBKGlGWMBXNoZWxslIWUdJQu", "rule": "pca", "input": ["/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/filtered.hg19.sorted.bed", "/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/filtered.hg19.sorted.bim", "/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/filtered.hg19.sorted.fam", "/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/filtered.hg19.sorted.log", "/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/filtered.hg19.sorted.nosex"], "log": [], "params": ["'/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/filtered.hg19.sorted'", "'/u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca'", "'/u/project/gandalm/shared/refGenomes/g1000/Phase3_ALL/ALL.autosomes.phase3'"], "shellcmd": "\n        . /u/local/Modules/default/init/modules.sh\n        module load plink/1.90b3.45\n        mkdir -p /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca\n        mkdir -p /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/plink_log\n\n        # 0. In tutorial, but not doing: filter reference and study data for non A-T or G-C SNPs\n\t\n\t# 1. Prune study data. Filter for variants in LD with r^2>.2 in a 50kb window\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/filtered.hg19.sorted               --indep-pairwise 50 5 0.2               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data\n\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/filtered.hg19.sorted               --extract /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.prune.in               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.pruned\n\t\n\t# 2. Filter reference data for the same SNP set as in study. Reduce reference to the same size\n        plink --bfile /u/project/gandalm/shared/refGenomes/g1000/Phase3_ALL/ALL.autosomes.phase3               --extract /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.prune.in               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.pruned\n        \n        # 3. Check and correct chromosome mismatch. Check that the variant IDs of the reference data have the same chromosome ID as the study data, update the pruned reference dataset\n        awk 'BEGIN {OFS=\"\t\"} FNR==NR {a[$2]=$1; next}         ($2 in a && a[$2] != $1) {print a[$2],$2}'         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.pruned.bim /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.pruned.bim |         sed -n '/^[XY]/!p' > /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.toUpdateChr\n        \n        # Correct chromosome mismatch\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.pruned               --update-chr /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.toUpdateChr 1 2               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.updateChr\n        \n        # 4. Check and correct position mismatch\n        awk 'BEGIN {OFS=\"\t\"} FNR==NR {a[$2]=$4; next}         ($2 in a && a[$2] != $4) {print a[$2],$2}'         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.pruned.bim /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.pruned.bim >         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.toUpdatePos\n\n        # Possible allele flips\n        awk 'BEGIN {OFS=\"\t\"} FNR==NR {a[$1$2$4]=$5$6; next}         ($1$2$4 in a && a[$1$2$4] != $5$6 && a[$1$2$4] != $6$5) {print $2}'         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.pruned.bim /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.pruned.bim >         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.toFlip\n\n        # Update position and allele flips\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.updateChr               --update-map /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.toUpdatePos 1 2               --flip /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.toFlip               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.flipped\n        \n        # 5. Remove mismatches in ref. Any alleles not matching after allele flipping are identified and removed from the reference\n        awk 'BEGIN {OFS=\"\t\"} FNR==NR {a[$1$2$4]=$5$6; next}         ($1$2$4 in a && a[$1$2$4] != $5$6 && a[$1$2$4] != $6$5) {print $2}'         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.pruned.bim /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.flipped.bim >         /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.mismatch\n\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.flipped               --exclude /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.mismatch               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.clean\n\n        # 6. Merge study genotypes and ref\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.pruned               --bmerge /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.clean.bed               /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.clean.bim               /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/ref.clean.fam               --make-bed               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.merge.ref\n        \n        # 7. PCA on the merged data\n        plink --bfile /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.merge.ref               --pca               --out /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/data.ref\n        \n        mv /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/*.log /u/project/gandalm/cindywen/isoform_twas/genotype/all_data/isec_R2_greater_than_3/ancestry/pca/plink_log\n        ", "incomplete": false, "starttime": 1614626674.977509, "endtime": 1614626675.078749, "job_hash": 8784550851044, "conda_env": null, "container_img_url": null}